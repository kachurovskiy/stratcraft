<style>
  .settings-form input[type='number']::-webkit-outer-spin-button,
  .settings-form input[type='number']::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }

  .settings-form input[type='number'] {
    -moz-appearance: textfield;
    appearance: textfield;
  }
</style>

<div class="container-fluid">
  <div class="d-flex flex-column flex-lg-row justify-content-lg-between align-items-lg-center gap-3 mb-3">
    <div>
      <h1 class="h2 mb-1">Settings</h1>
      <p class="text-muted mb-0">
        {{#each groups}}
          <a href="#settings-group-{{@index}}">{{label}}</a>
          {{#unless @last}}&middot;{{/unless}}
        {{/each}}
        </p>
    </div>
  </div>

  <form method="POST" action="/admin/settings" class="settings-form">
    {{> csrf-field}}

    <div class="row row-cols-1 row-cols-lg-2 row-cols-xxl-3 g-3 mb-3">
      {{#each groups}}
        <div class="col">
          <div id="settings-group-{{@index}}" class="card shadow-sm h-100">
            <div class="card-header py-2">
              <div class="fw-semibold">{{label}}</div>
              {{#if description}}
                <div class="text-muted small">{{description}}</div>
              {{/if}}
            </div>
            <div class="card-body p-3">
              {{#each settings}}
                <div class="mb-3">
                  <label for="setting-{{key}}" class="form-label mb-1">{{label}}</label>
                  {{#if isTextarea}}
                    <textarea
                      id="setting-{{key}}"
                      class="form-control form-control-sm font-monospace {{#unless value}}border-warning{{/unless}}"
                      name="{{key}}"
                      rows="{{rows}}"
                      placeholder="{{placeholder}}"
                      autocomplete="off"
                    >{{value}}</textarea>
                  {{else}}
                    <input
                      id="setting-{{key}}"
                      type="{{inputType}}"
                      class="form-control form-control-sm {{#unless value}}border-warning{{/unless}}"
                      name="{{key}}"
                      value="{{value}}"
                      placeholder="{{placeholder}}"
                      {{#if min}} min="{{min}}"{{/if}}
                      {{#if (eq inputType 'number')}} step="any"{{/if}}
                      autocomplete="off"
                    />
                  {{/if}}
                  {{#if description}}
                    <div class="form-text">{{description}}</div>
                  {{/if}}
                  {{#unless value}}
                    <div class="form-text text-warning">Empty</div>
                  {{/unless}}
                </div>
              {{/each}}
            </div>
          </div>
        </div>
      {{/each}}
    </div>

    <div class="d-flex flex-wrap gap-2">
      <button type="submit" class="btn btn-primary btn-sm">
        <i class="fas fa-save me-1"></i>
        Save Settings
      </button>
      <a href="/dashboard" class="btn btn-outline-secondary btn-sm">
        Cancel
      </a>
    </div>
  </form>
</div>
